test {
  name: "PrependRequestBody"
  request_headers {
    input {
      header { key: "Modify-Request-Body-Start" value: "0" }
      header { key: "Modify-Request-Body-Length" value: "0" }
      header { key: "Modify-Request-Body-Data" value: "Prepend body: " }
    }
  }
  request_body {
    input { content: "Standard request body" }
    result { body { exact: "Prepend body: Standard request body" } }
  }
}
test {
  name: "AppendRequestBody"
  request_headers {
    input {
      header { key: "Modify-Request-Body-Start" value: "100" }
      header { key: "Modify-Request-Body-Length" value: "0" }
      header { key: "Modify-Request-Body-Data" value: " :Append body" }
    }
  }
  request_body {
    input { content: "Standard request body" }
    result { body { exact: "Standard request body :Append body" } }
  }
}
test {
  name: "ReplaceStartRequestBody"
  request_headers {
    input {
      header { key: "Modify-Request-Body-Start" value: "0" }
      header { key: "Modify-Request-Body-Length" value: "8" }
      header { key: "Modify-Request-Body-Data" value: "Replaced start:" }
    }
  }
  request_body {
    input { content: "Standard request body" }
    result { body { exact: "Replaced start: request body" } }
  }
}
test {
  name: "ReplaceMiddleRequestBody"
  request_headers {
    input {
      header { key: "Modify-Request-Body-Start" value: "9" }
      header { key: "Modify-Request-Body-Length" value: "7" }
      header { key: "Modify-Request-Body-Data" value: ":Replaced middle:" }
    }
  }
  request_body {
    input { content: "Standard request body" }
    result { body { exact: "Standard :Replaced middle: body" } }
  }
}
test {
  name: "ReplaceEndRequestBody"
  request_headers {
    input {
      header { key: "Modify-Request-Body-Start" value: "16" }
      header { key: "Modify-Request-Body-Length" value: "1000" }
      header { key: "Modify-Request-Body-Data" value: " :Replaced end" }
    }
  }
  request_body {
    input { content: "Standard request body" }
    result { body { exact: "Standard request :Replaced end" } }
  }
}
test {
  name: "PrependResponseBody"
  request_headers {
    input {
      header { key: "Modify-Response-Body-Start" value: "0" }
      header { key: "Modify-Response-Body-Length" value: "0" }
      header { key: "Modify-Response-Body-Data" value: "Prepend body: "}
    }
  }
  response_body {
    input { content: "Standard response body" }
    result { body { exact: "Prepend body: Standard response body" } }
  }
}
test {
  name: "InvalidModificationValue"
  request_headers {
    input {
      header { key: "Modify-Response-Body-Start" value: "-1" }
      header { key: "Modify-Response-Body-Length" value: "0" }
      header { key: "Modify-Response-Body-Data" value: "Prepend body: "}
    }
    result {
      immediate {http_status: 400 details: "Invalid Modify-Response-Body-Start: -1"}
    }
  }
}