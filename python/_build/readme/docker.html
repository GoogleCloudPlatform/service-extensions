

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Docker &mdash; Google Cloud Service Extensions Samples  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=2f82ef1c" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Callout Server" href="../extproc/service/callout_server.html" />
    <link rel="prev" title="Tests" href="tests.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Google Cloud Service Extensions Samples
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Callout Server:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#setup">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#running-the-server">Running the Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="developing_callouts.html">Developing Callouts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="developing_callouts.html#creating-a-new-server">Creating a New Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing_callouts.html#additional-details">Additional Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing_callouts.html#using-the-proto-files">Using the Proto Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="alternative_install_methods.html">Alternative Install Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="alternative_install_methods.html#without-venv">Without venv</a></li>
<li class="toctree-l2"><a class="reference internal" href="alternative_install_methods.html#without-installing-proto-code-as-a-local-package">Without Installing Proto Code as a Local Package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">Tests</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Docker</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#building-docker-images">Building Docker Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples-with-unique-dependencies">Examples with unique dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-docker-files">Custom Docker Files</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Services</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extproc/service/callout_server.html">Callout Server</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/service/callout_server.html#class-definition">Class Definition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer"><code class="docutils literal notranslate"><span class="pre">CalloutServer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.address"><code class="docutils literal notranslate"><span class="pre">CalloutServer.address</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.port"><code class="docutils literal notranslate"><span class="pre">CalloutServer.port</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.health_check_address"><code class="docutils literal notranslate"><span class="pre">CalloutServer.health_check_address</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.health_check_port"><code class="docutils literal notranslate"><span class="pre">CalloutServer.health_check_port</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.combined_health_check"><code class="docutils literal notranslate"><span class="pre">CalloutServer.combined_health_check</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.secure_health_check"><code class="docutils literal notranslate"><span class="pre">CalloutServer.secure_health_check</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.plaintext_address"><code class="docutils literal notranslate"><span class="pre">CalloutServer.plaintext_address</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.plaintext_port"><code class="docutils literal notranslate"><span class="pre">CalloutServer.plaintext_port</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.disable_plaintext"><code class="docutils literal notranslate"><span class="pre">CalloutServer.disable_plaintext</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.default_ip"><code class="docutils literal notranslate"><span class="pre">CalloutServer.default_ip</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.cert_chain"><code class="docutils literal notranslate"><span class="pre">CalloutServer.cert_chain</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.cert_chain_path"><code class="docutils literal notranslate"><span class="pre">CalloutServer.cert_chain_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.private_key"><code class="docutils literal notranslate"><span class="pre">CalloutServer.private_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.private_key_path"><code class="docutils literal notranslate"><span class="pre">CalloutServer.private_key_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.server_thread_count"><code class="docutils literal notranslate"><span class="pre">CalloutServer.server_thread_count</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/service/callout_server.html#calloutserver-methods">CalloutServer Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.run"><code class="docutils literal notranslate"><span class="pre">CalloutServer.run()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.shutdown"><code class="docutils literal notranslate"><span class="pre">CalloutServer.shutdown()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer._start_servers"><code class="docutils literal notranslate"><span class="pre">CalloutServer._start_servers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer._stop_servers"><code class="docutils literal notranslate"><span class="pre">CalloutServer._stop_servers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer._loop_server"><code class="docutils literal notranslate"><span class="pre">CalloutServer._loop_server()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.process"><code class="docutils literal notranslate"><span class="pre">CalloutServer.process()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.on_request_headers"><code class="docutils literal notranslate"><span class="pre">CalloutServer.on_request_headers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.on_response_headers"><code class="docutils literal notranslate"><span class="pre">CalloutServer.on_response_headers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.on_request_body"><code class="docutils literal notranslate"><span class="pre">CalloutServer.on_request_body()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.CalloutServer.on_response_body"><code class="docutils literal notranslate"><span class="pre">CalloutServer.on_response_body()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/service/callout_server.html#healthcheckservice-class">HealthCheckService Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.HealthCheckService"><code class="docutils literal notranslate"><span class="pre">HealthCheckService</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server.HealthCheckService.do_GET"><code class="docutils literal notranslate"><span class="pre">HealthCheckService.do_GET()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/service/callout_server.html#grpc-callout-service">GRPC Callout Service</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server._GRPCCalloutService"><code class="docutils literal notranslate"><span class="pre">_GRPCCalloutService</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extproc/service/callout_server.html#callouts.python.extproc.service.callout_server._GRPCCalloutService.Process"><code class="docutils literal notranslate"><span class="pre">_GRPCCalloutService.Process()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extproc/service/callout_tools.html">Callout Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/service/callout_tools.html#callouts.python.extproc.service.callout_tools.add_body_mutation"><code class="docutils literal notranslate"><span class="pre">add_body_mutation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/service/callout_tools.html#callouts.python.extproc.service.callout_tools.add_header_mutation"><code class="docutils literal notranslate"><span class="pre">add_header_mutation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/service/callout_tools.html#callouts.python.extproc.service.callout_tools.body_contains"><code class="docutils literal notranslate"><span class="pre">body_contains()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/service/callout_tools.html#callouts.python.extproc.service.callout_tools.build_dynamic_forwarding_metadata"><code class="docutils literal notranslate"><span class="pre">build_dynamic_forwarding_metadata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/service/callout_tools.html#callouts.python.extproc.service.callout_tools.deny_callout"><code class="docutils literal notranslate"><span class="pre">deny_callout()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/service/callout_tools.html#callouts.python.extproc.service.callout_tools.header_immediate_response"><code class="docutils literal notranslate"><span class="pre">header_immediate_response()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/service/callout_tools.html#callouts.python.extproc.service.callout_tools.headers_contain"><code class="docutils literal notranslate"><span class="pre">headers_contain()</span></code></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Callouts Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extproc/ext_proc_client.html">External Processing Client</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/ext_proc_client.html#callouts.python.extproc.example.ext_proc_client.make_json_request"><code class="docutils literal notranslate"><span class="pre">make_json_request()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extproc/e2e_tests/metadata_server.html">Metadata Server</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/e2e_tests/metadata_server.html#callouts.python.extproc.example.e2e_tests.metadata_server.CalloutServerExample"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/e2e_tests/metadata_server.html#callouts.python.extproc.example.e2e_tests.metadata_server.CalloutServerExample.process"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.process()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/e2e_tests/metadata_server.html#callouts.python.extproc.example.e2e_tests.metadata_server.check_metadata"><code class="docutils literal notranslate"><span class="pre">check_metadata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/e2e_tests/metadata_server.html#callouts.python.extproc.example.e2e_tests.metadata_server.unpack_string"><code class="docutils literal notranslate"><span class="pre">unpack_string()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extproc/e2e_tests/observability_server.html">Observability Server</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/e2e_tests/observability_server.html#callouts.python.extproc.example.e2e_tests.observability_server.ObservabilityServerExample"><code class="docutils literal notranslate"><span class="pre">ObservabilityServerExample</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/e2e_tests/observability_server.html#callouts.python.extproc.example.e2e_tests.observability_server.ObservabilityServerExample.on_request_body"><code class="docutils literal notranslate"><span class="pre">ObservabilityServerExample.on_request_body()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/e2e_tests/observability_server.html#callouts.python.extproc.example.e2e_tests.observability_server.ObservabilityServerExample.on_request_headers"><code class="docutils literal notranslate"><span class="pre">ObservabilityServerExample.on_request_headers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/e2e_tests/observability_server.html#callouts.python.extproc.example.e2e_tests.observability_server.ObservabilityServerExample.on_response_body"><code class="docutils literal notranslate"><span class="pre">ObservabilityServerExample.on_response_body()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/e2e_tests/observability_server.html#callouts.python.extproc.example.e2e_tests.observability_server.ObservabilityServerExample.on_response_headers"><code class="docutils literal notranslate"><span class="pre">ObservabilityServerExample.on_response_headers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/e2e_tests/observability_server.html#callouts.python.extproc.example.e2e_tests.observability_server.ObservabilityServerExample.shutdown"><code class="docutils literal notranslate"><span class="pre">ObservabilityServerExample.shutdown()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/e2e_tests/observability_server.html#callouts.python.extproc.example.e2e_tests.observability_server.RequestHandler"><code class="docutils literal notranslate"><span class="pre">RequestHandler</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/e2e_tests/observability_server.html#callouts.python.extproc.example.e2e_tests.observability_server.RequestHandler.do_GET"><code class="docutils literal notranslate"><span class="pre">RequestHandler.do_GET()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extproc/add_body/service_callout_example.html">Add Body</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/add_body/service_callout_example.html#callouts.python.extproc.example.add_body.service_callout_example.CalloutServerExample"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/add_body/service_callout_example.html#callouts.python.extproc.example.add_body.service_callout_example.CalloutServerExample.on_request_body"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_request_body()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/add_body/service_callout_example.html#callouts.python.extproc.example.add_body.service_callout_example.CalloutServerExample.on_response_body"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_response_body()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extproc/add_header/service_callout_example.html">Add Header</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/add_header/service_callout_example.html#callouts.python.extproc.example.add_header.service_callout_example.CalloutServerExample"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/add_header/service_callout_example.html#callouts.python.extproc.example.add_header.service_callout_example.CalloutServerExample.on_request_headers"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_request_headers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/add_header/service_callout_example.html#callouts.python.extproc.example.add_header.service_callout_example.CalloutServerExample.on_response_headers"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_response_headers()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extproc/add_custom_response/service_callout_example.html">Add Custom Response</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/add_custom_response/service_callout_example.html#callouts.python.extproc.example.add_custom_response.service_callout_example.CalloutServerExample"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/add_custom_response/service_callout_example.html#callouts.python.extproc.example.add_custom_response.service_callout_example.CalloutServerExample.on_request_body"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_request_body()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/add_custom_response/service_callout_example.html#callouts.python.extproc.example.add_custom_response.service_callout_example.CalloutServerExample.on_request_headers"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_request_headers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/add_custom_response/service_callout_example.html#callouts.python.extproc.example.add_custom_response.service_callout_example.CalloutServerExample.on_response_body"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_response_body()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/add_custom_response/service_callout_example.html#callouts.python.extproc.example.add_custom_response.service_callout_example.CalloutServerExample.on_response_headers"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_response_headers()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/add_custom_response/service_callout_example.html#callouts.python.extproc.example.add_custom_response.service_callout_example.generate_mock_body_response"><code class="docutils literal notranslate"><span class="pre">generate_mock_body_response()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/add_custom_response/service_callout_example.html#callouts.python.extproc.example.add_custom_response.service_callout_example.generate_mock_header_response"><code class="docutils literal notranslate"><span class="pre">generate_mock_header_response()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extproc/set_cookie/service_callout_example.html">Set Cookie</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/set_cookie/service_callout_example.html#callouts.python.extproc.example.set_cookie.service_callout_example.CalloutServerExample"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/set_cookie/service_callout_example.html#callouts.python.extproc.example.set_cookie.service_callout_example.CalloutServerExample.on_response_headers"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_response_headers()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/set_cookie/service_callout_example.html#callouts.python.extproc.example.set_cookie.service_callout_example.validate_header"><code class="docutils literal notranslate"><span class="pre">validate_header()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extproc/redirect/service_callout_example.html">Redirect</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/redirect/service_callout_example.html#callouts.python.extproc.example.redirect.service_callout_example.CalloutServerExample"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/redirect/service_callout_example.html#callouts.python.extproc.example.redirect.service_callout_example.CalloutServerExample.on_request_headers"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_request_headers()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extproc/update_header/service_callout_example.html">Update Header</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/update_header/service_callout_example.html#callouts.python.extproc.example.update_header.service_callout_example.CalloutServerExample"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/update_header/service_callout_example.html#callouts.python.extproc.example.update_header.service_callout_example.CalloutServerExample.on_request_headers"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_request_headers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/update_header/service_callout_example.html#callouts.python.extproc.example.update_header.service_callout_example.CalloutServerExample.on_response_headers"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_response_headers()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extproc/cloud_log/service_callout_example.html">Cloud Log</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/cloud_log/service_callout_example.html#callouts.python.extproc.example.cloud_log.service_callout_example.CalloutServerExample"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/cloud_log/service_callout_example.html#callouts.python.extproc.example.cloud_log.service_callout_example.CalloutServerExample.on_request_body"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_request_body()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/cloud_log/service_callout_example.html#callouts.python.extproc.example.cloud_log.service_callout_example.CalloutServerExample.on_request_headers"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_request_headers()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extproc/jwt_auth/service_callout_example.html">JWT Auth</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/jwt_auth/service_callout_example.html#callouts.python.extproc.example.jwt_auth.service_callout_example.CalloutServerExample"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/jwt_auth/service_callout_example.html#callouts.python.extproc.example.jwt_auth.service_callout_example.CalloutServerExample.on_request_headers"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_request_headers()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/jwt_auth/service_callout_example.html#callouts.python.extproc.example.jwt_auth.service_callout_example.extract_jwt_token"><code class="docutils literal notranslate"><span class="pre">extract_jwt_token()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/jwt_auth/service_callout_example.html#callouts.python.extproc.example.jwt_auth.service_callout_example.validate_jwt_token"><code class="docutils literal notranslate"><span class="pre">validate_jwt_token()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extproc/normalize_header/service_callout_example.html">Normalize Header</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extproc/normalize_header/service_callout_example.html#callouts.python.extproc.example.normalize_header.service_callout_example.CalloutServerExample"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extproc/normalize_header/service_callout_example.html#callouts.python.extproc.example.normalize_header.service_callout_example.CalloutServerExample.add_device_type_header"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.add_device_type_header()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../extproc/normalize_header/service_callout_example.html#callouts.python.extproc.example.normalize_header.service_callout_example.CalloutServerExample.on_request_headers"><code class="docutils literal notranslate"><span class="pre">CalloutServerExample.on_request_headers()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extproc/normalize_header/service_callout_example.html#callouts.python.extproc.example.normalize_header.service_callout_example.get_device_type"><code class="docutils literal notranslate"><span class="pre">get_device_type()</span></code></a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Google Cloud Service Extensions Samples</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Docker</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/GoogleCloudPlatform/service-extensions/blob/main/docs/readme/docker.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="docker">
<span id="id1"></span><h1>Docker<a class="headerlink" href="#docker" title="Link to this heading"></a></h1>
<section id="building-docker-images">
<h2>Building Docker Images<a class="headerlink" href="#building-docker-images" title="Link to this heading"></a></h2>
<p>The basic Docker image contains arguments for pointing to and running python modules.</p>
<p>For example, to build <code class="docutils literal notranslate"><span class="pre">extproc/example/basic/service_callout_example.py</span></code> run:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>build<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-f<span class="w"> </span>./extproc/example/Dockerfile<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-t<span class="w"> </span>service-callout-example-python<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--build-arg<span class="w"> </span><span class="nv">copy_path</span><span class="o">=</span>extproc/example/basic/<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--build-arg<span class="w"> </span><span class="nv">run_module</span><span class="o">=</span>service_callout_example<span class="w"> </span>.
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">--build-arg</span></code> specifies the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">copy_path</span></code>: Required files to copy to the docker image.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">run_module</span></code>: The python module to run on startup.</p></li>
</ul>
<p>The above example makes a copy of <code class="docutils literal notranslate"><span class="pre">extproc/example/basic/service_callout_example.py</span></code>
and sets up the image to run <code class="docutils literal notranslate"><span class="pre">service_callout_example.py</span></code> on startup.</p>
<p>The image can then be run with:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>-P<span class="w"> </span>-it<span class="w"> </span>--network<span class="w"> </span>host<span class="w"> </span>service-callout-example-python:latest
</pre></div>
</div>
<p>In this example, using the <code class="docutils literal notranslate"><span class="pre">-P</span></code> flag tells docker to connect the exposed ports to the local machine’s ports.
Setting <code class="docutils literal notranslate"><span class="pre">--network</span> <span class="pre">host</span></code> tells docker to connect the image to the <code class="docutils literal notranslate"><span class="pre">0.0.0.0</span></code> or <code class="docutils literal notranslate"><span class="pre">localhost</span></code> ip address.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The docker image is set up to pass command line arguments to the module when specified.
This also requires that the example is set up to use command line arguments as well,
like in <code class="docutils literal notranslate"><span class="pre">basic/service_callout_example.py</span></code></p>
</div>
<p>For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>-P<span class="w"> </span>-it<span class="w"> </span>--network<span class="w"> </span>host<span class="w"> </span>service-callout-example-python:latest<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--<span class="w"> </span>--combined_health_check
</pre></div>
</div>
<p>Will run the health check for <code class="docutils literal notranslate"><span class="pre">basic/service_callout_example.py</span></code> combined with the main grpc server.</p>
</section>
<section id="examples-with-unique-dependencies">
<h2>Examples with unique dependencies<a class="headerlink" href="#examples-with-unique-dependencies" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">cloud_log</span></code> and <code class="docutils literal notranslate"><span class="pre">jwt_auth</span></code> examples require additional libraries to function.
For instance, the <code class="docutils literal notranslate"><span class="pre">cloud_log</span></code> example requires the <code class="docutils literal notranslate"><span class="pre">google-cloud-logging</span></code> library.
In this case, we need more than just the python file.
We copy <code class="docutils literal notranslate"><span class="pre">additional-requirements.txt</span></code> along with <code class="docutils literal notranslate"><span class="pre">service_callout_example.py</span></code> by
specifying the folder <code class="docutils literal notranslate"><span class="pre">extproc/example/cloud_log</span></code> as the <code class="docutils literal notranslate"><span class="pre">copy_path</span></code>.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>build<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-f<span class="w"> </span>./extproc/example/Dockerfile<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-t<span class="w"> </span>service-callout-example-python<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--build-arg<span class="w"> </span><span class="nv">copy_path</span><span class="o">=</span>extproc/example/cloud_log<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--build-arg<span class="w"> </span><span class="nv">run_module</span><span class="o">=</span>service_callout_example<span class="w"> </span>.
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">./extproc/example/Dockerfile</span></code> is set up to detect additional dependencies when present,
and install them.</p>
<p>Both the <code class="docutils literal notranslate"><span class="pre">cloud_log</span></code> and <code class="docutils literal notranslate"><span class="pre">jwt_auth</span></code> examples can be built this way.
If even more configurability is needed, a custom Docker image example is also available.</p>
</section>
<section id="custom-docker-files">
<h2>Custom Docker Files<a class="headerlink" href="#custom-docker-files" title="Link to this heading"></a></h2>
<p>If the baseline docker file does not contain the required complexity for a given use case.
A custom image can be created and branched from the common image.
<code class="docutils literal notranslate"><span class="pre">./extproc/example/Dockerfile</span></code> is internally split up into two steps,
a common image step and the example specific image step.</p>
<p>For instance, the <code class="docutils literal notranslate"><span class="pre">jwt_auth</span></code> example requires an additional python library much like <code class="docutils literal notranslate"><span class="pre">cloud_log</span></code>.
We can also accomplish the same goal as the <code class="docutils literal notranslate"><span class="pre">cloud_log</span></code> example through a custom Docker image.
<code class="docutils literal notranslate"><span class="pre">./extproc/example/jwt_auth/Dockerfile</span></code> installs the dependencies as part of the image setup.</p>
<p>To build the <code class="docutils literal notranslate"><span class="pre">jwt_auth</span></code> example we first build the common image:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>build<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-f<span class="w"> </span>./extproc/example/Dockerfile<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--target<span class="w"> </span>service-callout-common-python<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-t<span class="w"> </span>service-callout-common-python<span class="w"> </span>.
</pre></div>
</div>
<p>and then the <code class="docutils literal notranslate"><span class="pre">jwt_auth</span></code> image:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>build<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-f<span class="w"> </span>./extproc/example/jwt_auth/Dockerfile<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-t<span class="w"> </span>service-callout-jwt-example-python<span class="w"> </span>.
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tests.html" class="btn btn-neutral float-left" title="Tests" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../extproc/service/callout_server.html" class="btn btn-neutral float-right" title="Callout Server" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Google LLC.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>